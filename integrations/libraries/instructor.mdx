---
title: "Instructor"
description: "Add observability and reliability to your Instructor structured output pipelines."
---

[Instructor](https://python.useinstructor.com/) extracts structured outputs from LLMs, available in Python & JS.

## Quick Start

<CodeGroup>

```python Python
import instructor
from pydantic import BaseModel
from openai import OpenAI

client = instructor.from_openai(OpenAI(
    base_url="https://api.portkey.ai/v1",
    api_key="PORTKEY_API_KEY",
    default_headers={"x-portkey-provider": "@openai-prod"}
))

class User(BaseModel):
    name: str
    age: int

user = client.chat.completions.create(
    model="gpt-4o",
    response_model=User,
    messages=[{"role": "user", "content": "John Doe is 30 years old."}]
)

print(user.name, user.age)  # John Doe 30
```

```javascript JavaScript
import Instructor from "@instructor-ai/instructor";
import OpenAI from "openai";
import { z } from "zod";

const client = Instructor({
    client: new OpenAI({
        baseURL: "https://api.portkey.ai/v1",
        apiKey: "PORTKEY_API_KEY",
        defaultHeaders: { "x-portkey-provider": "@openai-prod" }
    }),
    mode: "TOOLS"
});

const UserSchema = z.object({
    name: z.string(),
    age: z.number()
});

const user = await client.chat.completions.create({
    model: "gpt-4o",
    response_model: { schema: UserSchema, name: "User" },
    messages: [{ role: "user", content: "John Doe is 30 years old." }]
});

console.log(user);  // { name: "John Doe", age: 30 }
```

</CodeGroup>

## Setup

<Steps>
<Step title="Add Provider">
Go to [Model Catalog](https://app.portkey.ai/model-catalog) → **Add Provider** → Select your provider → Enter credentials.
</Step>

<Step title="Get Portkey API Key">
Create your API key at [app.portkey.ai/api-keys](https://app.portkey.ai/api-keys).
</Step>
</Steps>

## Switch Providers

Change the provider header to use different LLMs:

<CodeGroup>

```python Anthropic
client = instructor.from_openai(OpenAI(
    base_url="https://api.portkey.ai/v1",
    api_key="PORTKEY_API_KEY",
    default_headers={"x-portkey-provider": "@anthropic-prod"}
))

user = client.chat.completions.create(
    model="claude-sonnet-4-20250514",
    response_model=User,
    messages=[{"role": "user", "content": "John Doe is 30 years old."}]
)
```

```python Google
client = instructor.from_openai(OpenAI(
    base_url="https://api.portkey.ai/v1",
    api_key="PORTKEY_API_KEY",
    default_headers={"x-portkey-provider": "@google-prod"}
))

user = client.chat.completions.create(
    model="gemini-2.0-flash",
    response_model=User,
    messages=[{"role": "user", "content": "John Doe is 30 years old."}]
)
```

</CodeGroup>

## Add Caching

Reduce costs with response caching:

<CodeGroup>

```python Python
from portkey_ai import createHeaders

cache_config = {"cache": {"mode": "simple"}}

client = instructor.from_openai(OpenAI(
    base_url="https://api.portkey.ai/v1",
    api_key="PORTKEY_API_KEY",
    default_headers=createHeaders(
        provider="@openai-prod",
        config=cache_config  # Or use config ID from Portkey app
    )
))
```

```javascript JavaScript
const cacheConfig = { cache: { mode: "simple" } };

const client = Instructor({
    client: new OpenAI({
        baseURL: "https://api.portkey.ai/v1",
        apiKey: "PORTKEY_API_KEY",
        defaultHeaders: {
            "x-portkey-provider": "@openai-prod",
            "x-portkey-config": JSON.stringify(cacheConfig)
        }
    }),
    mode: "TOOLS"
});
```

</CodeGroup>

## Advanced Features

Add [fallbacks](/product/ai-gateway/fallbacks), [load balancing](/product/ai-gateway/load-balancing), [timeouts](/product/ai-gateway/request-timeouts), or [retries](/product/ai-gateway/automatic-retries) via [Portkey Configs](/product/ai-gateway/configs).

<CardGroup cols={2}>
  <Card title="Configs Guide" icon="gear" href="/product/ai-gateway/configs">
    Set up routing, caching, and reliability
  </Card>
  <Card title="Model Catalog" icon="list" href="/product/model-catalog">
    Manage providers and credentials
  </Card>
</CardGroup>

import AdvancedFeatures from '/snippets/portkey-advanced-features.mdx';

<AdvancedFeatures />