---
title: "Azure Deployment Architectures"
description: "Complete architecture and service requirements for deploying Portkey on Azure"
---

This guide provides complete architecture and service requirements for deploying Portkey on Azure for both **Hybrid** and **Full Private (Airgapped)** deployment models.

## Deployment Models

| Deployment Model | Description |
|:-----------------|:------------|
| **Hybrid** | Data Plane runs in your Azure environment; Control Plane hosted by Portkey |
| **Full Private (Airgapped)** | Both Data Plane and Control Plane run entirely in your Azure environment |

---

## Hybrid Deployment

In a Hybrid deployment, only the **Data Plane** components are deployed in your Azure environment. The **Control Plane** (dashboard, config management, analytics) is hosted and managed by Portkey.

### Architecture Diagram


┌─────────────────────────────────────────────────────────────────┐
│                     Your Azure Environment                       │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                    AKS Cluster                            │   │
│  │                                                           │   │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │   │
│  │   │ AI Gateway  │    │ Data Service│    │    Redis    │  │   │
│  │   │  (2 pods)   │────│   (1 pod)   │────│  (optional) │  │   │
│  │   └──────┬──────┘    └─────────────┘    └─────────────┘  │   │
│  │          │                                                │   │
│  └──────────┼────────────────────────────────────────────────┘   │
│             │                                                     │
│   ┌─────────▼─────────┐         ┌─────────────────────────────┐  │
│   │   Load Balancer   │         │    Azure Blob Storage       │  │
│   └─────────┬─────────┘         │    (Log Store)              │  │
│             │                    └─────────────────────────────┘  │
│             │                    ┌─────────────────────────────┐  │
│             │                    │   Azure Managed Redis       │  │
│             │                    │   (Cache - recommended)     │  │
└─────────────┼────────────────────└─────────────────────────────┘  │
              │                                                      │
              │ HTTPS (Config Sync & Metrics)                       │
              ▼                                                      │
┌─────────────────────────────────────────────────────────────────┐
│                    Portkey Control Plane                         │
│            (Dashboard, Config Management, Analytics)             │
└─────────────────────────────────────────────────────────────────┘


### Required Azure Services

| Component | Azure Service | Sizing Recommendation |
|:----------|:-------------|:---------------------|
| **Kubernetes Cluster** | Azure Kubernetes Service (AKS) | 4 vCPU, 8 GB RAM (minimum) |
| **Cache Store** | Azure Managed Redis | 6 GB (Basic or Standard tier) |
| **Log Store** | Azure Blob Storage | Serverless (no provisioned storage required) |
| **Load Balancer** | Azure Load Balancer | Standard tier (created via AKS Load Balancer Controller) |
| **Authentication** | Entra ID or Managed Identity | Access to Blob Storage |

### Deployed Containers

| Container | Description | Default Replicas |
|:----------|:------------|:----------------|
| `AI Gateway` | Routes LLM requests, applies guardrails, caching, and metering | 2 |
| `Data Service` | Handles log storage and retrieval | 1 |
| `Redis` (optional) | In-cluster cache if not using Azure Managed Redis | 1 |

### Network Requirements

<Note>
**Portkey Control Plane IP**: `44.221.117.129` — whitelist this for inbound access if storing logs locally.
</Note>

| Direction | Requirement |
|:----------|:-----------|
| **Outbound HTTPS** | Required for config sync with Portkey Control Plane |
| **Inbound HTTPS** | Required for Control Plane to fetch logs (if storing logs locally) |

---

## Full Private (Airgapped) Deployment

In a Full Private deployment, **all components** run within your Azure environment. This includes the complete Control Plane with the web dashboard, backend services, and analytics infrastructure.

### Architecture Diagram

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                          Your Azure Environment                               │
│                                                                               │
│  ┌────────────────────────────────────────────────────────────────────────┐  │
│  │                           AKS Cluster                                   │  │
│  │                                                                         │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │  │
│  │  │  Frontend   │  │   Backend   │  │ AI Gateway  │  │ Data Service│   │  │
│  │  │   (Web UI)  │  │   (API)     │  │  (2 pods)   │  │   (1 pod)   │   │  │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘   │  │
│  │         │                │                │                │          │  │
│  │         └────────────────┴────────────────┴────────────────┘          │  │
│  │                                    │                                   │  │
│  │  ┌─────────────┐  ┌─────────────┐  │  ┌─────────────┐                 │  │
│  │  │    Redis    │  │    MySQL    │  │  │ ClickHouse  │                 │  │
│  │  │  (in-cluster│  │ (in-cluster │  │  │ (in-cluster │                 │  │
│  │  │  or managed)│  │  or managed)│  │  │  or managed)│                 │  │
│  │  └─────────────┘  └─────────────┘  │  └─────────────┘                 │  │
│  │                                    │                                   │  │
│  └────────────────────────────────────┼───────────────────────────────────┘  │
│                                       │                                       │
│  ┌────────────────────────────────────▼───────────────────────────────────┐  │
│  │                           Load Balancer                                 │  │
│  └────────────────────────────────────────────────────────────────────────┘  │
│                                                                               │
│  ┌─────────────────────────────────┐  ┌─────────────────────────────────┐   │
│  │     Azure Blob Storage          │  │     Azure Managed Redis         │   │
│  │     (Log Store)                 │  │     (Recommended)               │   │
│  └─────────────────────────────────┘  └─────────────────────────────────┘   │
│                                                                               │
│  ┌─────────────────────────────────┐                                         │
│  │     Azure Database for MySQL    │                                         │
│  │     (Recommended)               │                                         │
│  └─────────────────────────────────┘                                         │
│                                                                               │
└──────────────────────────────────────────────────────────────────────────────┘
```

### Required Azure Services

| Component | Azure Service | Sizing Recommendation |
|:----------|:-------------|:---------------------|
| **Kubernetes Cluster** | Azure Kubernetes Service (AKS) | 16 vCPU, 32 GB RAM (minimum) |
| **Transactional Database** | Azure Database for MySQL | Flexible Server: 4 vCPU, 16 GB RAM |
| **Cache Store** | Azure Managed Redis | 6 GB (Standard tier recommended) |
| **Log Store** | Azure Blob Storage | Serverless (no provisioned storage required) |
| **Load Balancer** | Azure Load Balancer | Standard tier (created via AKS Load Balancer Controller) |
| **Authentication** | Entra ID or Managed Identity | Access to Blob Storage |

### Deployed Containers

| Container | Description | Default Replicas |
|:----------|:------------|:----------------|
| `Frontend` | Web UI dashboard (React + Nginx) | 1 |
| `Backend` | REST API server for business logic | 1 |
| `AI Gateway` | Routes LLM requests, applies guardrails, caching, and metering | 2 |
| `Data Service` | Handles log storage, exports, and retrieval | 1 |
| `ClickHouse` | Analytics and metrics database (can be external) | 1 |
| `MySQL` (optional) | Transactional database if not using Azure MySQL | 1 |
| `Redis` (optional) | In-cluster cache if not using Azure Managed Redis | 1 |

### Network Requirements

<Info>
**No outbound internet required** — This deployment is fully airgapped. Container images must be pre-loaded or pulled from a private registry.
</Info>

Internal load balancer recommended for private network access.

---

## Comparison Summary

| Aspect | Hybrid | Full Private (Airgapped) |
|:-------|:-------|:-------------------------|
| **AKS Sizing** | 4 vCPU, 8 GB RAM | 16 vCPU, 32 GB RAM |
| **Azure MySQL** | Not required | 4 vCPU, 16 GB RAM |
| **Azure Managed Redis** | 6 GB | 6 GB |
| **Azure Blob Storage** | Serverless | Serverless |
| **Load Balancer** | Required | Required |
| **ClickHouse** | Not required (analytics in Portkey Cloud) | Required (in-cluster or managed) |
| **Internet Access** | Required (outbound to Portkey) | Not required |
| **Dashboard** | Hosted by Portkey | Self-hosted |

---

## Authentication Options for Azure Blob Storage

Both deployment models require access to Azure Blob Storage for log storage. Choose one of the following authentication methods:

<AccordionGroup>
  <Accordion title="Option 1: Managed Identity (Recommended)" icon="shield-check">
    ```yaml values.yaml
    environment:
      data:
        LOG_STORE: azure
        AZURE_STORAGE_ACCOUNT: <STORAGE_ACCOUNT_NAME>
        AZURE_STORAGE_CONTAINER: <CONTAINER_NAME>
        AZURE_AUTH_MODE: managed
    ```

    **Setup**: Grant the AKS kubelet identity `Storage Blob Data Contributor` role on the blob container.
  </Accordion>

  <Accordion title="Option 2: Entra ID (Service Principal)" icon="key">
    ```yaml values.yaml
    environment:
      data:
        LOG_STORE: azure
        AZURE_STORAGE_ACCOUNT: <STORAGE_ACCOUNT_NAME>
        AZURE_STORAGE_CONTAINER: <CONTAINER_NAME>
        AZURE_AUTH_MODE: entra
        AZURE_ENTRA_CLIENT_ID: <CLIENT_ID>
        AZURE_ENTRA_CLIENT_SECRET: <CLIENT_SECRET>
        AZURE_ENTRA_TENANT_ID: <TENANT_ID>
    ```
  </Accordion>
</AccordionGroup>

---

## Quick Reference: Service Sizing

<Tabs>
  <Tab title="Hybrid Deployment">
    | Service | SKU/Size | Notes |
    |:--------|:---------|:------|
    | AKS Node Pool | Standard_D2s_v3 or equivalent | 2 vCPU, 8 GB per node; 2 nodes recommended for HA |
    | Azure Managed Redis | Basic C1 or Standard C1 | 6 GB cache |
    | Azure Blob Storage | General Purpose v2 | Hot tier, LRS redundancy |
    | Load Balancer | Standard | Auto-provisioned by AKS |
  </Tab>
  <Tab title="Full Private Deployment">
    | Service | SKU/Size | Notes |
    |:--------|:---------|:------|
    | AKS Node Pool | Standard_D4s_v3 or equivalent | 4 vCPU, 16 GB per node; 4 nodes recommended |
    | Azure Database for MySQL | Flexible Server GP_Standard_D4ds_v4 | 4 vCPU, 16 GB RAM |
    | Azure Managed Redis | Standard C1 | 6 GB cache |
    | Azure Blob Storage | General Purpose v2 | Hot tier, LRS redundancy |
    | Load Balancer | Standard | Auto-provisioned by AKS |
  </Tab>
</Tabs>

---

## Next Steps

<Steps>
  <Step title="Hybrid Deployment" icon="cloud">
    Follow the [Azure Hybrid Deployment Guide](/product/enterprise-offering/private-cloud-deployments/azure) for step-by-step instructions.
  </Step>
  <Step title="Full Private Deployment" icon="lock">
    Contact the Portkey team for full private deployment Helm charts and license keys.
  </Step>
  <Step title="Access Helm Charts" icon="code">
    All Helm charts are available at the [Portkey Helm repository](https://github.com/Portkey-AI/helm).
  </Step>
</Steps>

---

## Additional Resources

<CardGroup cols={2}>
  <Card title="Helm Charts" icon="github" href="https://github.com/Portkey-AI/helm">
    Access deployment manifests and configuration templates
  </Card>
  <Card title="Security Overview" icon="shield" href="/enterprise/security">
    Compare security postures across deployment models
  </Card>
  <Card title="PoC Options" icon="flask" href="/enterprise/poc">
    Evaluate Portkey with a proof-of-concept deployment
  </Card>
  <Card title="Contact Enterprise Team" icon="envelope" href="mailto:support@portkey.ai">
    Get architecture reviews and sizing guidance
  </Card>
</CardGroup>
